<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MB - Mobios.ru</title>
  <meta name="description" content="–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –æ–¥–µ–∂–¥—ã, –æ–±—É–≤–∏ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ –≤ Mobios.ru. –®–∏—Ä–æ–∫–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç, –∞–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏.">
  <meta name="keywords" content="–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω, –æ–¥–µ–∂–¥–∞, –æ–±—É–≤—å, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã Mobios.ru">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      transition: background-color 0.3s, color 0.3s;
    }
    .wb-purple { background-color: #4A0072; }
    .wb-pink { background-color: #E6007E; }
    .wb-text-purple { color: #4A0072; }
    .wb-text-pink { color: #E6007E; }
    .cart-count, .favorites-count {
      width: 18px;
      height: 18px;
      background-color: #E6007E;
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 18px;
      font-size: 10px;
      position: absolute;
      top: -8px;
      right: -8px;
    }
    .carousel {
      scroll-behavior: smooth;
      overflow-x: auto;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }
    .carousel::-webkit-scrollbar { display: none; }
    .product-card img {
      transition: transform 0.3s ease;
    }
    .product-card img:hover { transform: scale(1.05); }
    .sidebar { transition: transform 0.3s ease-in-out; }
    @media (max-width: 768px) {
      .sidebar { transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
    }
    .pagination button { transition: background-color 0.3s; }
    .pagination button:hover { background-color: #E6007E; color: white; }
    .quick-view {
      transition: opacity 0.3s;
      opacity: 0;
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
    }
    .product-card:hover .quick-view { opacity: 1; }
    .discount {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: #E6007E;
      color: white;
      padding: 4px 8px;
      font-size: 12px;
      border-radius: 3px;
      font-weight: bold;
    }
    .promo-tag {
      background-color: #FFD700;
      color: #4A0072;
      padding: 2px 6px;
      font-size: 12px;
      border-radius: 3px;
      display: inline-block;
      margin-top: 4px;
    }
    .header-shadow { box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
    .category:hover { background-color: #f3e8ff; }
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #4A0072;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 50;
      display: none;
    }
    .suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 10;
      display: none;
    }
    .suggestions div {
      padding: 8px;
      cursor: pointer;
    }
    .suggestions div:hover { background-color: #f3e8ff; }
    .dark-mode {
      background-color: #1a1a1a;
      color: #f5f5f5;
    }
    .dark-mode .bg-white { background-color: #2a2a2a; }
    .dark-mode .text-gray-700 { color: #d5d5d5; }
    .dark-mode .wb-text-purple { color: #9b59b6; }
    .dark-mode .wb-pink { background-color: #d9534f; }
    .dark-mode .bg-gray-100 { background-color: #333; }
    .chatbot-btn {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background-color: #4A0072;
      color: white;
      padding: 10px 20px;
      border-radius: 50px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 50;
    }
    .chatbot-modal {
      position: fixed;
      bottom: 80px;
      left: 20px;
      width: 300px;
      max-height: 400px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      overflow-y: auto;
      z-index: 50;
      display: none;
    }
    .chatbot-message {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
    }
    .chatbot-message.user { background-color: #f3e8ff; text-align: right; }
    .chatbot-message.bot { background-color: #e0f7fa; }
    .close-sidebar {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- Notification -->
  <div id="notification" class="notification"></div>

  <!-- Header -->
  <header class="wb-purple text-white p-4 sticky top-0 z-20 header-shadow">
    <div class="container mx-auto flex justify-between items-center">
      <div class="flex items-center space-x-4">
        <button id="menu-toggle" class="md:hidden text-white">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
          </svg>
        </button>
        <h1 class="text-2xl font-bold">Mob</h1>
      </div>
      <div class="flex items-center space-x-6">
        <div class="relative">
          <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤, –±—Ä–µ–Ω–¥–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π..." class="p-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-pink-500 w-64 hidden md:block">
          <div id="search-suggestions" class="suggestions"></div>
        </div>
        <select id="currency" class="bg-transparent text-white border-none">
          <option value="rub">‚ÇΩru</option>
          <option value="usd">$usd</option>
        </select>
        <button id="dark-mode-toggle" class="text-white">üåô</button>
        <button id="login-toggle" class="hover:underline text-sm"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#FFFFFF"><path d="M234-276q51-39 114-61.5T480-360q69 0 132 22.5T726-276q35-41 54.5-93T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 59 19.5 111t54.5 93Zm246-164q-59 0-99.5-40.5T340-580q0-59 40.5-99.5T480-720q59 0 99.5 40.5T620-580q0 59-40.5 99.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q53 0 100-15.5t86-44.5q-39-29-86-44.5T480-280q-53 0-100 15.5T294-220q39 29 86 44.5T480-160Zm0-360q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm0-60Zm0 360Z"/></svg></button>
        <div class="relative">
          <button id="favorites-toggle" class="hover:underline flex items-center text-sm">
            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
            <span id="favorites-count" class="favorites-count">0</span>
          </button>
        </div>
        <div class="relative">
          <button id="cart-toggle" class="hover:underline flex items-center text-sm">
            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
            <span id="cart-count" class="cart-count">0</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Sidebar -->
  <aside id="sidebar" class="bg-white w-72 fixed top-0 left-0 h-full shadow-lg z-20 sidebar">
    <div class="p-6 relative">
      <button id="close-sidebar" class="close-sidebar md:hidden">√ó</button>
      <h2 class="text-xl font-bold mb-6 wb-text-purple">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
      <ul id="categories" class="space-y-3">
        <li><button class="w-full text-left p-3 hover:bg-purple-100 rounded category bg-purple-100 font-medium" data-category="all">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</button></li>
        <li><button class="w-full text-left p-3 hover:bg-purple-100 rounded category font-medium" data-category="clothing">–û–¥–µ–∂–¥–∞</button></li>
        <li><button class="w-full text-left p-3 hover:bg-purple-100 rounded category font-medium" data-category="shoes">–û–±—É–≤—å</button></li>
        <li><button class="w-full text-left p-3 hover:bg-purple-100 rounded category font-medium" data-category="accessories">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</button></li>
      </ul>
      <h2 class="text-xl font-bold mt-8 mb-6 wb-text-purple">–§–∏–ª—å—Ç—Ä—ã</h2>
      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">–¶–µ–Ω–∞</label>
        <div class="flex space-x-2">
          <input type="number" id="min-price" placeholder="–û—Ç" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <input type="number" id="max-price" placeholder="–î–æ" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
        </div>
      </div>
      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">–ë—Ä–µ–Ω–¥</label>
        <select id="brand-filter" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <option value="">–í—Å–µ –±—Ä–µ–Ω–¥—ã</option>
          <option value="BrandA">Brand A</option>
          <option value="BrandB">Brand B</option>
          <option value="BrandC">Brand C</option>
        </select>
      </div>
      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">–†–∞–∑–º–µ—Ä</label>
        <select id="size-filter" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <option value="">–í—Å–µ —Ä–∞–∑–º–µ—Ä—ã</option>
          <option value="S">S</option>
          <option value="M">M</option>
          <option value="L">L</option>
          <option value="XL">XL</option>
        </select>
      </div>
      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">–¶–≤–µ—Ç</label>
        <select id="color-filter" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <option value="">–í—Å–µ —Ü–≤–µ—Ç–∞</option>
          <option value="black">–ß—ë—Ä–Ω—ã–π</option>
          <option value="white">–ë–µ–ª—ã–π</option>
          <option value="blue">–°–∏–Ω–∏–π</option>
          <option value="red">–ö—Ä–∞—Å–Ω—ã–π</option>
        </select>
      </div>
      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">–ù–∞–ª–∏—á–∏–µ</label>
        <select id="availability-filter" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <option value="">–í—Å–µ</option>
          <option value="in_stock">–í –Ω–∞–ª–∏—á–∏–∏</option>
          <option value="out_of_stock">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-2">–†–µ–π—Ç–∏–Ω–≥</label>
        <select id="rating-filter" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <option value="0">–õ—é–±–æ–π</option>
          <option value="4">4+ –∑–≤–µ–∑–¥—ã</option>
          <option value="3">3+ –∑–≤–µ–∑–¥—ã</option>
          <option value="2">2+ –∑–≤–µ–∑–¥—ã</option>
        </select>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="container mx-auto py-8 md:ml-72">
    <!-- Breadcrumbs -->
    <div class="mb-6 px-4">
      <nav class="text-sm wb-text-purple">
        <a href="#" class="hover:underline">–ì–ª–∞–≤–Ω–∞—è</a> / <a href="#" class="hover:underline">–ö–∞—Ç–∞–ª–æ–≥</a> / <span class="text-gray-500">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</span>
      </nav>
    </div>

    <!-- Banner Carousel -->
    <div class="mb-8 px-4">
      <div class="carousel flex space-x-4">
        <img src="https://avatars.mds.yandex.net/i?id=fd0adec26190e18335279a2fdec6979e_l-9228658-images-thumbs&n=13"alt="–ù–æ–≤–∏–Ω–∫–∏ –æ—Å–µ–Ω–∏" class="rounded-lg w-full max-w-4xl">
        <img src="https://gipermed.ru/upload/iblock/a23/a236760bf006b1d165733559b3ecddc6.jpg" alt="–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞" class="rounded-lg w-full max-w-4xl">
      </div>
    </div>

    <!-- Mobile Search -->
    <div class="mb-6 md:hidden px-4 relative">
      <input type="text" id="mobile-search" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤, –±—Ä–µ–Ω–¥–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π..." class="w-full p-3 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
      <div id="mobile-search-suggestions" class="suggestions"></div>
    </div>

    <!-- Sorting and Comparison -->
    <div class="flex justify-between items-center mb-6 px-4">
      <h2 class="text-2xl font-bold wb-text-purple">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</h2>
      <div class="flex space-x-4">
        <select id="sort" class="p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
          <option value="default">–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
          <option value="price-asc">–¶–µ–Ω–∞: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
          <option value="price-desc">–¶–µ–Ω–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
          <option value="rating-desc">–†–µ–π—Ç–∏–Ω–≥: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
          <option value="discount-desc">–°–∫–∏–¥–∫–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
        </select>
        <button id="compare-toggle" class="bg-wb-pink text-white px-4 py-2 rounded-full hover:bg-pink-700">–°—Ä–∞–≤–Ω–∏—Ç—å (<span id="compare-count">0</span>)</button>
      </div>
    </div>

    <!-- Products Grid -->
    <div id="products" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 px-4">
      <!-- Products will be dynamically inserted here -->
    </div>

    <!-- Pagination -->
    <div class="flex justify-center space-x-2 mt-8">
      <div id="pagination" class="pagination flex space-x-2"></div>
    </div>
  </main>

  <!-- Quick View Modal -->
  <div id="quick-view-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-md">
      <h2 id="quick-view-name" class="text-xl font-bold mb-4 wb-text-purple"></h2>
      <img id="quick-view-image" src="" alt="–¢–æ–≤–∞—Ä" class="w-full h-64 object-cover rounded-lg mb-4">
      <p id="quick-view-price" class="text-lg font-semibold mb-4"></p>
      <button id="quick-view-details" class="wb-pink text-white px-6 py-2 rounded-full hover:bg-pink-700">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
      <button id="close-quick-view" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 ml-4">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Product Detail Modal -->
  <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-3xl">
      <div class="flex flex-col md:flex-row">
        <div class="md:w-1/2">
          <div class="product-carousel relative">
            <div id="product-images" class="carousel flex">
              <!-- Images will be inserted here -->
            </div>
            <button id="prev-image" class="absolute top-1/2 left-2 transform -translate-y-1/2 bg-gray-200 p-2 rounded-full hover:bg-gray-300">‚Üê</button>
            <button id="next-image" class="absolute top-1/2 right-2 transform -translate-y-1/2 bg-gray-200 p-2 rounded-full hover:bg-gray-300">‚Üí</button>
          </div>
        </div>
        <div class="md:w-1/2 md:pl-8 mt-4 md:mt-0">
          <h2 id="product-name" class="text-2xl font-bold mb-2 wb-text-purple"></h2>
          <p id="product-price" class="text-xl font-semibold mb-2"></p>
          <p id="product-rating" class="text-yellow-500 mb-4">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</p>
          <div class="mb-4">
            <label class="block text-sm font-medium mb-1">–†–∞–∑–º–µ—Ä</label>
            <select id="product-size" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
              <option value="S">S</option>
              <option value="M">M</option>
              <option value="L">L</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium mb-1">–¶–≤–µ—Ç</label>
            <select id="product-color" class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
              <option value="black">–ß—ë—Ä–Ω—ã–π</option>
              <option value="white">–ë–µ–ª—ã–π</option>
              <option value="blue">–°–∏–Ω–∏–π</option>
            </select>
          </div>
          <p id="product-description" class="text-gray-700 mb-6"></p>
          <div class="flex space-x-4">
            <button id="add-to-cart-modal" class="wb-pink text-white px-6 py-2 rounded-full hover:bg-pink-700">–í –∫–æ—Ä–∑–∏–Ω—É</button>
            <button id="toggle-favorite" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
              –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
            </button>
            <button id="share-product" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg>
              –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
            </button>
            <button id="compare-product" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h18M3 8h18M3 12h18M3 16h18M3 20h18"></path></svg>
              –°—Ä–∞–≤–Ω–∏—Ç—å
            </button>
          </div>
        </div>
      </div>
      <div class="mt-8">
        <h3 class="text-xl font-bold mb-4 wb-text-purple">–û—Ç–∑—ã–≤—ã</h3>
        <div id="reviews" class="space-y-6">
          <!-- Reviews will be dynamically inserted here -->
        </div>
        <div class="mt-4">
          <textarea id="review-text" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π –æ—Ç–∑—ã–≤..." class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none h-24"></textarea>
          <div class="flex items-center mt-2">
            <label class="mr-2">–û—Ü–µ–Ω–∫–∞:</label>
            <select id="review-rating" class="p-1 rounded-lg border border-gray-300">
              <option value="5">5 –∑–≤—ë–∑–¥</option>
              <option value="4">4 –∑–≤–µ–∑–¥—ã</option>
              <option value="3">3 –∑–≤–µ–∑–¥—ã</option>
              <option value="2">2 –∑–≤–µ–∑–¥—ã</option>
              <option value="1">1 –∑–≤–µ–∑–¥–∞</option>
            </select>
            <button id="submit-review" class="ml-4 wb-pink text-white px-4 py-1 rounded-full hover:bg-pink-700">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          </div>
        </div>
      </div>
      <div class="mt-8">
        <h3 class="text-xl font-bold mb-4 wb-text-purple">–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã</h3>
        <div id="recommended-products" class="grid grid-cols-2 gap-4">
          <!-- Recommended products will be inserted here -->
        </div>
      </div>
      <button id="close-product" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 mt-6 w-full">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Cart Modal -->
  <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-lg">
      <h2 class="text-xl font-bold mb-6 wb-text-purple">–ö–æ—Ä–∑–∏–Ω–∞</h2>
      <div id="cart-items" class="mb-6 max-h-64 overflow-y-auto">
        <!-- Cart items will be dynamically inserted here -->
      </div>
      <p class="font-bold text-lg">–ò—Ç–æ–≥–æ: <span id="cart-total">0 ‚ÇΩ</span></p>
      <div class="flex justify-end space-x-4 mt-6">
        <button id="close-cart" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button id="checkout" class="wb-pink text-white px-6 py-2 rounded-full hover:bg-pink-700">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
      </div>
    </div>
  </div>

  <!-- Favorites Modal -->
  <div id="favorites-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-lg">
      <h2 class="text-xl font-bold mb-6 wb-text-purple">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>
      <div id="favorites-items" class="mb-6 max-h-64 overflow-y-auto">
        <!-- Favorites items will be dynamically inserted here -->
      </div>
      <div class="flex justify-end mt-6">
        <button id="close-favorites" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-md">
      <h2 class="text-xl font-bold mb-6 wb-text-purple">–í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
      <div id="login-email-section">
        <input type="email" id="login-email" placeholder="Email" class="w-full p-3 mb-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
        <button id="send-code" class="wb-pink text-white px-6 py-3 rounded-full hover:bg-pink-700 w-full">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥</button>
      </div>
      <div id="login-code-section" class="hidden">
        <p class="mb-4">–ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤–∞—à email</p>
        <input type="text" id="verification-code" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥" class="w-full p-3 mb-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
        <button id="verify-code" class="wb-pink text-white px-6 py-3 rounded-full hover:bg-pink-700 w-full">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      </div>
      <button id="close-login" class="bg-gray-200 text-gray-700 px-6 py-3 rounded-full hover:bg-gray-300 w-full mt-4">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Personal Account Modal -->
  <div id="account-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-lg">
      <h2 class="text-xl font-bold mb-6 wb-text-purple">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
      <div id="profile-section" class="mb-6">
        <h3 class="font-semibold mb-2">–ü—Ä–æ—Ñ–∏–ª—å</h3>
        <p class="text-gray-700">–ò–º—è: <span id="profile-name">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</span></p>
        <p class="text-gray-700">Email: <span id="profile-email">ivan@example.com</span></p>
        <p class="text-gray-700">–¢–µ–ª–µ—Ñ–æ–Ω: <span id="profile-phone">+7 (999) 123-45-67</span></p>
        <button id="edit-profile" class="text-sm text-blue-500 hover:underline mt-2">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
      <div id="edit-profile-form" class="hidden mb-6">
        <input type="text" id="edit-name" placeholder="–ò–º—è" class="w-full p-2 mb-2 rounded-lg border border-gray-300">
        <input type="email" id="edit-email" placeholder="Email" class="w-full p-2 mb-2 rounded-lg border border-gray-300">
        <input type="tel" id="edit-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" class="w-full p-2 mb-4 rounded-lg border border-gray-300">
        <button id="save-profile" class="wb-pink text-white px-4 py-2 rounded-full hover:bg-pink-700">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="cancel-edit" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-full hover:bg-gray-300 ml-2">–û—Ç–º–µ–Ω–∞</button>
      </div>
      <div class="mb-6">
        <h3 class="font-semibold mb-2">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h3>
        <div id="order-history" class="space-y-4">
          <div class="border-b pb-2">
            <p class="font-medium">–ó–∞–∫–∞–∑ #12345 –æ—Ç 15.10.2023</p>
            <p class="text-gray-600">–°—É–º–º–∞: 4 999 ‚ÇΩ</p>
            <p class="text-green-600">–î–æ—Å—Ç–∞–≤–ª–µ–Ω</p>
            <button class="text-sm text-blue-500 hover:underline" onclick="trackOrder(12345)">–û—Ç—Å–ª–µ–¥–∏—Ç—å</button>
          </div>
          <div class="border-b pb-2">
            <p class="font-medium">–ó–∞–∫–∞–∑ #12346 –æ—Ç 20.10.2023</p>
            <p class="text-gray-600">–°—É–º–º–∞: 2 499 ‚ÇΩ</p>
            <p class="text-yellow-600">–í –ø—É—Ç–∏</p>
            <button class="text-sm text-blue-500 hover:underline" onclick="trackOrder(12346)">–û—Ç—Å–ª–µ–¥–∏—Ç—å</button>
          </div>
        </div>
      </div>
      <button id="logout" class="bg-red-500 text-white px-6 py-2 rounded-full hover:bg-red-700 w-full mb-4">–í—ã–π—Ç–∏</button>
      <button id="close-account" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 w-full">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Compare Modal -->
  <div id="compare-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-4xl">
      <h2 class="text-xl font-bold mb-6 wb-text-purple">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤</h2>
      <div id="compare-products" class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Compare products will be dynamically inserted here -->
      </div>
      <button id="close-compare" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 mt-6 w-full">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Order Tracking Modal -->
  <div id="track-order-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-30">
    <div class="bg-white p-6 rounded-lg w-full max-w-md">
      <h2 class="text-xl font-bold mb-4 wb-text-purple">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
      <p id="order-status" class="text-gray-700 mb-4"></p>
      <button id="close-track-order" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 w-full">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Chatbot -->
  <button id="chatbot-toggle"
  class="chatbot-btn">–ß–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</button>
<div id="chatbot-modal" class="chatbot-modal">
<div id="chatbot-messages" class="p-4"></div>
<div class="p-4 border-t">
  <input type="text" id="chatbot-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:outline-none">
  <button id="chatbot-send" class="wb-pink text-white px-4 py-2 rounded-full hover:bg-pink-700 mt-2 w-full">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>
</div>

<!-- Footer -->
<footer class="bg-gray-900 text-white p-6 mt-12">
<div class="container mx-auto grid grid-cols-1 md:grid-cols-4 gap-8">
  <div>
    <h3 class="font-bold mb-4">Mobi-web</h3>
    <p class="text-sm">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω Mobi-Web</p>
  </div>
  <div>
    <h3 class="font-bold mb-4">–ü–æ–∫—É–ø–∞—Ç–µ–ª—è–º</h3>
    <ul class="space-y-2 text-sm">
      <li><a href="#" class="hover:underline">–î–æ—Å—Ç–∞–≤–∫–∞</a></li>
      <li><a href="#" class="hover:underline">–û–ø–ª–∞—Ç–∞</a></li>
      <li><a href="#" class="hover:underline">–í–æ–∑–≤—Ä–∞—Ç</a></li>
    </ul>
  </div>
  <div>
    <h3 class="font-bold mb-4">–ö–∞—Ç–∞–ª–æ–≥</h3>
    <ul class="space-y-2 text-sm">
      <li><a href="#" class="hover:underline">–û–¥–µ–∂–¥–∞</a></li>
      <li><a href="#" class="hover:underline">–û–±—É–≤—å</a></li>
      <li><a href="#" class="hover:underline">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</a></li>
    </ul>
  </div>
  <div>
    <h3 class="font-bold mb-4">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
    <p class="text-sm">Email: support@moymarket.ru</p>
    <p class="text-sm">–¢–µ–ª–µ—Ñ–æ–Ω: 8 (996) 468-47-44</p>
  </div>
</div>
<div class="text-center text-sm mt-8">¬© 2025 Mobi-Web. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</div>
</footer>

<script>
// Sample products data with availability
const products = [
  {
    id: 1,
    name: "–§—É—Ç–±–æ–ª–∫–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è",
    price: 1299,
    originalPrice: 1999,
    category: "clothing",
    brand: "BrandA",
    rating: 4,
    images: ["",""],
    description: "–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è —Ö–ª–æ–ø–∫–æ–≤–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.",
    sizes: ["S", "M", "L", "XL"],
    colors: ["black", "white", "blue"],
    discount: 23,
    promo: "–•–∏—Ç –ø—Ä–æ–¥–∞–∂",
    availability: "in_stock",
    reviews: [
      { user: "–ò–≤–∞–Ω", rating: 5, text: "–û—Ç–ª–∏—á–Ω–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞!" },
      { user: "–ê–Ω–Ω–∞", rating: 4, text: "–•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–æ —Ü–≤–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –Ω–µ —Ç–æ—Ç." }
    ]
  },
  {
    id: 2,
    name: "–î–∂–∏–Ω—Å—ã Slim Fit",
    price: 2999,
    originalPrice: 3999,
    category: "clothing",
    brand: "BrandB",
    rating: 5,
    images: ["https://via.placeholder.com/300?text=–î–∂–∏–Ω—Å—ã+1", "https://via.placeholder.com/300?text=–î–∂–∏–Ω—Å—ã+2"],
    description: "–°—Ç–∏–ª—å–Ω—ã–µ –¥–∂–∏–Ω—Å—ã slim fit –∏–∑ –ø–ª–æ—Ç–Ω–æ–≥–æ –¥–µ–Ω–∏–º–∞.",
    sizes: ["S", "M", "L"],
    colors: ["black", "blue"],
    discount: 25,
    promo: "–ù–æ–≤–∏–Ω–∫–∞",
    availability: "in_stock",
    reviews: []
  },
  {
    id: 3,
    name: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏ –±–µ–≥–æ–≤—ã–µ",
    price: 3499,
    category: "shoes",
    brand: "BrandC",
    rating: 4,
    images: ["https://via.placeholder.com/300?text=–ö—Ä–æ—Å—Å–æ–≤–∫–∏+1", "https://via.placeholder.com/300?text=–ö—Ä–æ—Å—Å–æ–≤–∫–∏+2"],
    description: "–õ—ë–≥–∫–∏–µ –∏ —É–¥–æ–±–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏ –¥–ª—è –±–µ–≥–∞.",
    sizes: ["M", "L", "XL"],
    colors: ["white", "black", "red"],
    promo: "–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞",
    availability: "out_of_stock",
    reviews: [{ user: "–ü—ë—Ç—Ä", rating: 3, text: "–ù–µ–ø–ª–æ—Ö–∏–µ, –Ω–æ –Ω–µ –æ—á–µ–Ω—å —É–¥–æ–±–Ω—ã–µ." }]
  }
];

let cart = JSON.parse(localStorage.getItem('cart')) || [];
let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
let compareList = JSON.parse(localStorage.getItem('compare')) || [];
let selectedProduct = null;
let currentPage = 1;
const productsPerPage = 10;
let language = 'ru';
let currency = 'rub';
let darkMode = false;
let verificationCode = '';
let userEmail = '';
let isLoggedIn = false;

// DOM Elements
const productsContainer = document.getElementById('products');
const searchInput = document.getElementById('search');
const mobileSearchInput = document.getElementById('mobile-search');
const searchSuggestions = document.getElementById('search-suggestions');
const mobileSearchSuggestions = document.getElementById('mobile-search-suggestions');
const sortSelect = document.getElementById('sort');
const minPriceInput = document.getElementById('min-price');
const maxPriceInput = document.getElementById('max-price');
const brandFilter = document.getElementById('brand-filter');
const sizeFilter = document.getElementById('size-filter');
const colorFilter = document.getElementById('color-filter');
const availabilityFilter = document.getElementById('availability-filter');
const ratingFilter = document.getElementById('rating-filter');
const cartModal = document.getElementById('cart-modal');
const cartItemsContainer = document.getElementById('cart-items');
const cartTotal = document.getElementById('cart-total');
const cartCount = document.getElementById('cart-count');
const cartToggle = document.getElementById('cart-toggle');
const closeCart = document.getElementById('close-cart');
const checkout = document.getElementById('checkout');
const favoritesModal = document.getElementById('favorites-modal');
const favoritesItemsContainer = document.getElementById('favorites-items');
const favoritesToggle = document.getElementById('favorites-toggle');
const favoritesCount = document.getElementById('favorites-count');
const closeFavorites = document.getElementById('close-favorites');
const loginModal = document.getElementById('login-modal');
const loginToggle = document.getElementById('login-toggle');
const loginEmail = document.getElementById('login-email');
const sendCode = document.getElementById('send-code');
const loginCodeSection = document.getElementById('login-code-section');
const verificationCodeInput = document.getElementById('verification-code');
const verifyCode = document.getElementById('verify-code');
const closeLogin = document.getElementById('close-login');
const accountModal = document.getElementById('account-modal');
const closeAccount = document.getElementById('close-account');
const logout = document.getElementById('logout');
const sidebar = document.getElementById('sidebar');
const closeSidebar = document.getElementById('close-sidebar');
const menuToggle = document.getElementById('menu-toggle');
const categories = document.querySelectorAll('.category');
const productModal = document.getElementById('product-modal');
const productImages = document.getElementById('product-images');
const productName = document.getElementById('product-name');
const productPrice = document.getElementById('product-price');
const productRating = document.getElementById('product-rating');
const productDescription = document.getElementById('product-description');
const productSize = document.getElementById('product-size');
const productColor = document.getElementById('product-color');
const addToCartModal = document.getElementById('add-to-cart-modal');
const toggleFavorite = document.getElementById('toggle-favorite');
const shareProduct = document.getElementById('share-product');
const compareProduct = document.getElementById('compare-product');
const closeProduct = document.getElementById('close-product');
const prevImage = document.getElementById('prev-image');
const nextImage = document.getElementById('next-image');
const paginationContainer = document.getElementById('pagination');
const quickViewModal = document.getElementById('quick-view-modal');
const quickViewName = document.getElementById('quick-view-name');
const quickViewImage = document.getElementById('quick-view-image');
const quickViewPrice = document.getElementById('quick-view-price');
const quickViewDetails = document.getElementById('quick-view-details');
const closeQuickView = document.getElementById('close-quick-view');
const recommendedProducts = document.getElementById('recommended-products');
const compareModal = document.getElementById('compare-modal');
const compareProducts = document.getElementById('compare-products');
const closeCompare = document.getElementById('close-compare');
const compareToggle = document.getElementById('compare-toggle');
const compareCount = document.getElementById('compare-count');
const trackOrderModal = document.getElementById('track-order-modal');
const orderStatus = document.getElementById('order-status');
const closeTrackOrder = document.getElementById('close-track-order');
const notification = document.getElementById('notification');
const currencySelect = document.getElementById('currency');
const darkModeToggle = document.getElementById('dark-mode-toggle');
const reviewsContainer = document.getElementById('reviews');
const reviewText = document.getElementById('review-text');
const reviewRating = document.getElementById('review-rating');
const submitReview = document.getElementById('submit-review');
const profileName = document.getElementById('profile-name');
const profileEmail = document.getElementById('profile-email');
const profilePhone = document.getElementById('profile-phone');
const editProfile = document.getElementById('edit-profile');
const editProfileForm = document.getElementById('edit-profile-form');
const editName = document.getElementById('edit-name');
const editEmail = document.getElementById('edit-email');
const editPhone = document.getElementById('edit-phone');
const saveProfile = document.getElementById('save-profile');
const cancelEdit = document.getElementById('cancel-edit');
const chatbotToggle = document.getElementById('chatbot-toggle');
const chatbotModal = document.getElementById('chatbot-modal');
const chatbotMessages = document.getElementById('chatbot-messages');
const chatbotInput = document.getElementById('chatbot-input');
const chatbotSend = document.getElementById('chatbot-send');

// Show notification
function showNotification(message) {
  notification.textContent = message;
  notification.style.display = 'block';
  setTimeout(() => notification.style.display = 'none', 3000);
}

// Generate random verification code
function generateVerificationCode() {
  return Math.floor(100000 + Math.random() * 900000).toString();
}

// Simulate sending email with verification code
function sendVerificationCode(email) {
  verificationCode = generateVerificationCode();
  userEmail = email;
  showNotification(`–ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ ${email} (–∏–º–∏—Ç–∞—Ü–∏—è: ${verificationCode})`);
  return true;
}

// Verify entered code
function verifyEnteredCode(code) {
  return code === verificationCode;
}

// Login user
function loginUser(email) {
  isLoggedIn = true;
  profileEmail.textContent = email;
  loginModal.classList.add('hidden');
  accountModal.classList.remove('hidden');
  showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
}

// Logout user
function logoutUser() {
  isLoggedIn = false;
  verificationCode = '';
  userEmail = '';
  accountModal.classList.add('hidden');
  showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
}

// Render products
function renderProducts(filteredProducts = products) {
  if (!productsContainer) return;
  productsContainer.innerHTML = '';
  const start = (currentPage - 1) * productsPerPage;
  const end = start + productsPerPage;
  const paginatedProducts = filteredProducts.slice(start, end);

  paginatedProducts.forEach(product => {
    const isFavorite = favorites.some(fav => fav.id === product.id);
    const discountTag = product.discount ? `<span class="discount">-${product.discount}%</span>` : '';
    const price = currency === 'usd' ? (product.price / 75).toFixed(2) : product.price;
    const originalPrice = product.originalPrice ? (currency === 'usd' ? (product.originalPrice / 75).toFixed(2) : product.originalPrice) : null;
    const priceDisplay = originalPrice ? `<span class="line-through text-gray-500">${originalPrice} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span> <span class="text-red-500 font-semibold">${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span>` : `<span class="font-semibold">${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span>`;
    const promoTag = product.promo ? `<span class="promo-tag">${product.promo}</span>` : '';
    const availabilityText = product.availability === 'in_stock' ? (language === 'ru' ? '–í –Ω–∞–ª–∏—á–∏–∏' : 'In stock') : (language === 'ru' ? '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' : 'Out of stock');
    const productCard = `
      <div class="bg-white rounded-lg shadow-md overflow-hidden product-card relative">
        ${discountTag}
        <img src="${product.images[0]}" alt="${product.name}" class="w-full h-48 object-cover">
        <button onclick="toggleFavoriteFromList(${product.id}, event)" class="absolute top-2 right-2 text-2xl ${isFavorite ? 'text-red-500' : 'text-gray-300'} hover:text-red-500 transition-colors">‚ù§</button>
        <div class="p-4">
          <h3 class="text-md font-semibold wb-text-purple truncate">${product.name}</h3>
          <p class="text-gray-600 mt-1">${priceDisplay}</p>
          <p class="text-yellow-500 text-sm mt-1">${'‚òÖ'.repeat(product.rating)}${'‚òÜ'.repeat(5 - product.rating)}</p>
          <p class="text-sm ${product.availability === 'in_stock' ? 'text-green-500' : 'text-red-500'}">${availabilityText}</p>
          ${promoTag}
          <button onclick="openQuickView(${product.id})" class="quick-view wb-pink text-white px-4 py-1 rounded-full hover:bg-pink-700 text-sm mt-2">${language === 'ru' ? '–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä' : 'Quick View'}</button>
        </div>
      </div>
    `;
    productsContainer.innerHTML += productCard;
  });

  renderPagination(filteredProducts);
}

// Render pagination
function renderPagination(filteredProducts) {
  if (!paginationContainer) return;
  paginationContainer.innerHTML = '';
  const totalPages = Math.ceil(filteredProducts.length / productsPerPage);

  for (let i = 1; i <= totalPages; i++) {
    const button = `<button class="px-4 py-2 rounded-lg border border-gray-300 ${i === currentPage ? 'wb-pink text-white' : 'bg-white hover:bg-gray-100'}" onclick="changePage(${i})">${i}</button>`;
    paginationContainer.innerHTML += button;
  }
}

// Change page
window.changePage = function(page) {
  currentPage = page;
  applyFilters();
};

// Open quick view
function openQuickView(productId) {
  if (!quickViewModal) return;
  const product = products.find(p => p.id === productId);
  quickViewName.textContent = product.name;
  quickViewImage.src = product.images[0];
  const price = currency === 'usd' ? (product.price / 75).toFixed(2) : product.price;
  const originalPrice = product.originalPrice ? (currency === 'usd' ? (product.originalPrice / 75).toFixed(2) : product.originalPrice) : null;
  quickViewPrice.innerHTML = originalPrice ? `<span class="line-through text-gray-500">${originalPrice} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span> <span class="text-red-500">${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span>` : `${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}`;
  quickViewModal.classList.remove('hidden');
  quickViewDetails.onclick = () => {
    quickViewModal.classList.add('hidden');
    openProductModal(productId);
  };
}

// Open product modal
function openProductModal(productId) {
  if (!productModal) return;
  selectedProduct = products.find(p => p.id === productId);
  productImages.innerHTML = selectedProduct.images.map(img => `<img src="${img}" alt="${selectedProduct.name}" class="w-full h-64 object-cover rounded-lg">`).join('');
  productName.textContent = selectedProduct.name;
  const price = currency === 'usd' ? (selectedProduct.price / 75).toFixed(2) : selectedProduct.price;
  const originalPrice = selectedProduct.originalPrice ? (currency === 'usd' ? (selectedProduct.originalPrice / 75).toFixed(2) : selectedProduct.originalPrice) : null;
  productPrice.innerHTML = originalPrice ? `<span class="line-through text-gray-500">${originalPrice} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span> <span class="text-red-500">${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}</span>` : `${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}`;
  productRating.textContent = '‚òÖ'.repeat(selectedProduct.rating) + '‚òÜ'.repeat(5 - selectedProduct.rating);
  productDescription.textContent = selectedProduct.description;
  productSize.innerHTML = selectedProduct.sizes.map(size => `<option value="${size}">${size}</option>`).join('');
  productColor.innerHTML = selectedProduct.colors.map(color => `<option value="${color}">${color}</option>`).join('');
  toggleFavorite.innerHTML = favorites.some(fav => fav.id === productId) ? `<svg class="w-5 h-5 mr-2 text-red-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>${language === 'ru' ? '–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : 'Remove from favorites'}` : `<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>${language === 'ru' ? '–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' : 'Add to favorites'}`;
  compareProduct.innerHTML = compareList.some(comp => comp.id === productId) ? `<svg class="w-5 h-5 mr-2 text-blue-500" fill="currentColor" viewBox="0 0 24 24"><path d="M3 4h18M3 8h18M3 12h18M3 16h18M3 20h18"></path></svg>${language === 'ru' ? '–£–±—Ä–∞—Ç—å –∏–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è' : 'Remove from compare'}` : `<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h18M3 8h18M3 12h18M3 16h18M3 20h18"></path></svg>${language === 'ru' ? '–°—Ä–∞–≤–Ω–∏—Ç—å' : 'Compare'}`;
  productModal.classList.remove('hidden');

  // Render reviews
  reviewsContainer.innerHTML = selectedProduct.reviews.map(review => `
    <div class="border-b pb-4">
      <p class="font-semibold">${review.user}</p>
      <p class="text-yellow-500">${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5 - review.rating)}</p>
      <p>${review.text}</p>
    </div>
  `).join('');

  // Render recommended products
  const recommended = products.filter(p => p.id !== productId && p.category === selectedProduct.category).slice(0, 2);
  recommendedProducts.innerHTML = recommended.map(product => {
    const recPrice = currency === 'usd' ? (product.price / 75).toFixed(2) : product.price;
    return `
      <div class="bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal(${product.id})">
        <img src="${product.images[0]}" alt="${product.name}" class="w-full h-24 object-cover">
        <div class="p-2">
          <h4 class="text-sm font-semibold wb-text-purple truncate">${product.name}</h4>
          <p class="text-gray-600 text-sm">${recPrice} ${currency === 'usd' ? '$' : '‚ÇΩ'}</p>
        </div>
      </div>
    `;
  }).join('');
}

// Submit review
submitReview.addEventListener('click', () => {
  if (!selectedProduct || !reviewText.value.trim()) return;
  const newReview = {
    user: "–¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    rating: parseInt(reviewRating.value),
    text: reviewText.value.trim()
  };
  selectedProduct.reviews.push(newReview);
  reviewText.value = '';
  openProductModal(selectedProduct.id); // Refresh modal with new review
  showNotification(language === 'ru' ? '–û—Ç–∑—ã–≤ –¥–æ–±–∞–≤–ª–µ–Ω!' : 'Review added!');
});

// Carousel navigation
let currentImageIndex = 0;
function updateCarousel() {
  if (productImages) {
    productImages.scrollTo({ left: currentImageIndex * productImages.offsetWidth, behavior: 'smooth' });
  }
}

prevImage.addEventListener('click', () => {
  if (currentImageIndex > 0) {
    currentImageIndex--;
    updateCarousel();
  }
});

nextImage.addEventListener('click', () => {
  if (selectedProduct && currentImageIndex < selectedProduct.images.length - 1) {
    currentImageIndex++;
    updateCarousel();
  }
});

// Add to cart
function addToCart(productId) {
  const product = products.find(p => p.id === productId);
  const size = productSize.value;
  const color = productColor.value;
  const cartItem = cart.find(item => item.id === productId && item.size === size && item.color === color);

  if (cartItem) {
    cartItem.quantity++;
  } else {
    cart.push({ ...product, quantity: 1, size, color });
  }

  localStorage.setItem('cart', JSON.stringify(cart));
  updateCart();
  showNotification(language === 'ru' ? '–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!' : 'Item added to cart!');
}

// Update cart quantity
window.updateCartQuantity = function(productId, size, color, quantity) {
  const cartItem = cart.find(item => item.id === productId && item.size === size && item.color === color);
  if (cartItem) {
    cartItem.quantity = quantity;
    if (cartItem.quantity <= 0) {
      cart = cart.filter(item => item.id !== productId || item.size !== size || item.color !== color);
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCart();
  }
};

// Remove from cart
window.removeFromCart = function(productId, size, color) {
  cart = cart.filter(item => item.id !== productId || item.size !== size || item.color !== color);
  localStorage.setItem('cart', JSON.stringify(cart));
  updateCart();
  showNotification(language === 'ru' ? '–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã' : 'Item removed from cart');
};

// Update cart UI
function updateCart() {
  if (!cartItemsContainer || !cartTotal || !cartCount) return;
  cartItemsContainer.innerHTML = '';
  let total = 0;

  cart.forEach(item => {
    const itemPrice = currency === 'usd' ? (item.price / 75).toFixed(2) : item.price;
    total += itemPrice * item.quantity;
    const cartItem = `
      <div class="flex justify-between items-center mb-4 border-b pb-4">
        <div class="flex items-center">
          <img src="${item.images[0]}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg mr-4">
          <div>
            <p class="wb-text-purple font-medium">${item.name}</p>
            <p class="text-gray-600 text-sm">${item.size}, ${item.color}</p>
            <p class="text-gray-700">${itemPrice * item.quantity} ${currency === 'usd' ? '$' : '‚ÇΩ'}</p>
          </div>
        </div>
        <div class="flex items-center space-x-2">
          <button onclick="updateCartQuantity(${item.id}, '${item.size}', '${item.color}', ${item.quantity - 1})" class="bg-gray-200 px-2 py-1 rounded-full hover:bg-gray-300">-</button>
          <span class="font-medium">${item.quantity}</span>
          <button onclick="updateCartQuantity(${item.id}, '${item.size}', '${item.color}', ${item.quantity + 1})" class="bg-gray-200 px-2 py-1 rounded-full hover:bg-gray-300">+</button>
          <button onclick="removeFromCart(${item.id}, '${item.size}', '${item.color}')" class="text-red-500 hover:underline text-sm">${language === 'ru' ? '–£–¥–∞–ª–∏—Ç—å' : 'Remove'}</button>
        </div>
      </div>
    `;
    cartItemsContainer.innerHTML += cartItem;
  });

  cartTotal.textContent = `${total.toFixed(2)} ${currency === 'usd' ? '$' : '‚ÇΩ'}`;
  cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
}

// Toggle favorite
window.toggleFavoriteFromList = function(productId, event) {
  event.stopPropagation();
  const product = products.find(p => p.id === productId);
  const isFavorite = favorites.some(fav => fav.id === productId);

  if (isFavorite) {
    favorites = favorites.filter(fav => fav.id !== productId);
    showNotification(language === 'ru' ? '–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : 'Removed from favorites');
  } else {
    favorites.push(product);
    showNotification(language === 'ru' ? '–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' : 'Added to favorites');
  }

  localStorage.setItem('favorites', JSON.stringify(favorites));
  updateFavorites();
  renderProducts(applyFilters(true));
};

toggleFavorite.addEventListener('click', () => {
  if (!selectedProduct) return;
  const isFavorite = favorites.some(fav => fav.id === selectedProduct.id);
  if (isFavorite) {
    favorites = favorites.filter(fav => fav.id !== selectedProduct.id);
    showNotification(language === 'ru' ? '–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : 'Removed from favorites');
  } else {
    favorites.push(selectedProduct);
    showNotification(language === 'ru' ? '–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' : 'Added to favorites');
  }
  localStorage.setItem('favorites', JSON.stringify(favorites));
  toggleFavorite.innerHTML = isFavorite ? `<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>${language === 'ru' ? '–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' : 'Add to favorites'}` : `<svg class="w-5 h-5 mr-2 text-red-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>${language === 'ru' ? '–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : 'Remove from favorites'}`;
  updateFavorites();
  renderProducts(applyFilters(true));
});

// Update favorites UI
function updateFavorites() {
  if (!favoritesItemsContainer || !favoritesCount) return;
  favoritesItemsContainer.innerHTML = '';
  favorites.forEach(item => {
    const itemPrice = currency === 'usd' ? (item.price / 75).toFixed(2) : item.price;
    const favoriteItem = `
      <div class="flex justify-between items-center mb-4 border-b pb-4">
        <div class="flex items-center">
          <img src="${item.images[0]}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg mr-4">
          <div>
            <p class="wb-text-purple font-medium">${item.name}</p>
            <p class="text-gray-700">${itemPrice} ${currency === 'usd' ? '$' : '‚ÇΩ'}</p>
          </div>
        </div>
        <button onclick="toggleFavoriteFromList(${item.id}, event)" class="text-red-500 hover:underline text-sm">${language === 'ru' ? '–£–¥–∞–ª–∏—Ç—å' : 'Remove'}</button>
      </div>
    `;
    favoritesItemsContainer.innerHTML += favoriteItem;
  });
  favoritesCount.textContent = favorites.length;
}

// Apply filters
function applyFilters(returnFiltered = false) {
  const query = (searchInput.value || mobileSearchInput.value || '').toLowerCase();
  const selectedCategory = document.querySelector('.category.bg-purple-100')?.dataset.category || 'all';
  const minPrice = parseFloat(minPriceInput.value) || 0;
  const maxPrice = parseFloat(maxPriceInput.value) || Infinity;
  const selectedBrand = brandFilter.value;
  const selectedSize = sizeFilter.value;
  const selectedColor = colorFilter.value;
  const selectedAvailability = availabilityFilter.value;
  const minRating = parseInt(ratingFilter.value) || 0;

  let filteredProducts = products.filter(product => {
    const matchesSearch = product.name.toLowerCase().includes(query) || product.brand.toLowerCase().includes(query);
    const matchesCategory = selectedCategory === 'all' || product.category === selectedCategory;
    const productPrice = currency === 'usd' ? product.price / 75 : product.price;
    const matchesPrice = productPrice >= minPrice && productPrice <= maxPrice;
    const matchesBrand = !selectedBrand || product.brand === selectedBrand;
    const matchesSize = !selectedSize || product.sizes.includes(selectedSize);
    const matchesColor = !selectedColor || product.colors.includes(selectedColor);
    const matchesAvailability = !selectedAvailability || product.availability === selectedAvailability;
    const matchesRating = product.rating >= minRating;
    return matchesSearch && matchesCategory && matchesPrice && matchesBrand && matchesSize && matchesColor && matchesAvailability && matchesRating;
  });

  const sortValue = sortSelect.value;
  if (sortValue === 'price-asc') {
    filteredProducts.sort((a, b) => (currency === 'usd' ? a.price / 75 - b.price / 75 : a.price - b.price));
  } else if (sortValue === 'price-desc') {
    filteredProducts.sort((a, b) => (currency === 'usd' ? b.price / 75 - a.price / 75 : b.price - a.price));
  } else if (sortValue === 'rating-desc') {
    filteredProducts.sort((a, b) => b.rating - a.rating);
  } else if (sortValue === 'discount-desc') {
    filteredProducts.sort((a, b) => (b.discount || 0) - (a.discount || 0));
  }

  if (returnFiltered) return filteredProducts;
  renderProducts(filteredProducts);
}

// Search suggestions
function showSuggestions(input, suggestionsContainer) {
  const query = input.value.toLowerCase();
  if (query.length < 2) {
    suggestionsContainer.style.display = 'none';
    return;
  }
  const filtered = products.filter(p => p.name.toLowerCase().includes(query) || p.brand.toLowerCase().includes(query)).slice(0, 5);
  suggestionsContainer.innerHTML = filtered.map(p => `<div onclick="selectSuggestion('${p.name}')">${p.name} (${p.brand})</div>`).join('');
  suggestionsContainer.style.display = filtered.length ? 'block' : 'none';
}

window.selectSuggestion = function(value) {
  searchInput.value = value;
  mobileSearchInput.value = value;
  searchSuggestions.style.display = 'none';
  mobileSearchSuggestions.style.display = 'none';
  applyFilters();
};

// Share product
shareProduct.addEventListener('click', () => {
  if (!selectedProduct) return;
  const url = `${window.location.origin}/product/${selectedProduct.id}`;
  navigator.clipboard.writeText(url);
  showNotification(language === 'ru' ? '–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!' : 'Link copied to clipboard!');
});

// Compare products
compareProduct.addEventListener('click', () => {
  if (!selectedProduct) return;
  const isCompared = compareList.some(comp => comp.id === selectedProduct.id);
  if (isCompared) {
    compareList = compareList.filter(comp => comp.id !== selectedProduct.id);
    showNotification(language === 'ru' ? '–£–¥–∞–ª–µ–Ω–æ –∏–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è' : 'Removed from compare');
  } else if (compareList.length < 3) {
    compareList.push(selectedProduct);
    showNotification(language === 'ru' ? '–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ' : 'Removed from compare')
  } else {
        showNotification(language === 'ru' ? '–ú–∞–∫—Å–∏–º—É–º 3 —Ç–æ–≤–∞—Ä–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è' : 'Maximum 3 items for comparison');
      }
      localStorage.setItem('compare', JSON.stringify(compareList));
      updateCompareCount();
      openProductModal(selectedProduct.id); // Refresh modal
    });

    compareToggle.addEventListener('click', () => {
      if (compareList.length > 0) {
        compareModal.classList.remove('hidden');
        renderCompareProducts();
      } else {
        showNotification(language === 'ru' ? '–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è' : 'No items to compare');
      }
    });

    closeCompare.addEventListener('click', () => compareModal.classList.add('hidden'));

    function renderCompareProducts() {
      compareProducts.innerHTML = compareList.map(product => {
        const price = currency === 'usd' ? (product.price / 75).toFixed(2) : product.price;
        return `
          <div class="p-4 border rounded-lg">
            <img src="${product.images[0]}" alt="${product.name}" class="w-full h-32 object-cover rounded-lg mb-2">
            <h3 class="font-semibold wb-text-purple">${product.name}</h3>
            <p class="text-gray-600">${price} ${currency === 'usd' ? '$' : '‚ÇΩ'}</p>
            <p class="text-yellow-500">${'‚òÖ'.repeat(product.rating)}${'‚òÜ'.repeat(5 - product.rating)}</p>
            <button onclick="removeFromCompare(${product.id})" class="text-red-500 hover:underline text-sm mt-2">${language === 'ru' ? '–£–¥–∞–ª–∏—Ç—å' : 'Remove'}</button>
          </div>
        `;
      }).join('');
    }

    window.removeFromCompare = function(productId) {
      compareList = compareList.filter(comp => comp.id !== productId);
      localStorage.setItem('compare', JSON.stringify(compareList));
      updateCompareCount();
      renderCompareProducts();
      if (compareList.length === 0) compareModal.classList.add('hidden');
    };

    function updateCompareCount() {
      compareCount.textContent = compareList.length;
    }

    // Track order
    window.trackOrder = function(orderId) {
      const status = orderId === 12345 ? (language === 'ru' ? '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' : 'Delivered') : (language === 'ru' ? '–í –ø—É—Ç–∏' : 'In transit');
      orderStatus.textContent = `${language === 'ru' ? '–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞' : 'Order status'}: ${status}`;
      trackOrderModal.classList.remove('hidden');
    };

    closeTrackOrder.addEventListener('click', () => trackOrderModal.classList.add('hidden'));

    // Edit profile
    editProfile.addEventListener('click', () => {
      editName.value = profileName.textContent;
      editEmail.value = profileEmail.textContent;
      editPhone.value = profilePhone.textContent;
      editProfileForm.classList.remove('hidden');
    });

    saveProfile.addEventListener('click', () => {
      profileName.textContent = editName.value;
      profileEmail.textContent = editEmail.value;
      profilePhone.textContent = editPhone.value;
      editProfileForm.classList.add('hidden');
      showNotification(language === 'ru' ? '–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª—ë–Ω' : 'Profile updated');
    });

    cancelEdit.addEventListener('click', () => editProfileForm.classList.add('hidden'));

    // Language and currency switch
    currencySelect.addEventListener('change', (e) => {
      currency = e.target.value;
      renderProducts(applyFilters(true));
      updateCart();
    });

    // Dark mode toggle
    darkModeToggle.addEventListener('click', () => {
      darkMode = !darkMode;
      document.body.classList.toggle('dark-mode');
      darkModeToggle.textContent = darkMode ? '‚òÄÔ∏è' : 'üåô';
    });

    // Chatbot functionality
    const chatbotResponses = {
      ru: {
        greeting: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?",
        help: "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∏—Å–∫–æ–º —Ç–æ–≤–∞—Ä–æ–≤, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ –∏–ª–∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –¥–æ—Å—Ç–∞–≤–∫–µ. –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?",
        unknown: "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ –ø–æ–Ω—è–ª. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å."
      },
      en: {
        greeting: "Hello! How can I assist you?",
        help: "I can help with product search, order tracking, or answer questions about delivery. What are you interested in?",
        unknown: "Sorry, I didn‚Äôt understand. Please try rephrasing your question."
      }
    };

    function addChatbotMessage(message, isUser = false) {
      const messageDiv = document.createElement('div');
      messageDiv.classList.add('chatbot-message', isUser ? 'user' : 'bot');
      messageDiv.textContent = message;
      chatbotMessages.appendChild(messageDiv);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }

    function updateChatbotUI() {
      chatbotToggle.textContent = language === 'ru' ? '–ß–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π' : 'Support Chat';
      chatbotInput.placeholder = language === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...' : 'Enter message...';
      chatbotSend.textContent = language === 'ru' ? '–û—Ç–ø—Ä–∞–≤–∏—Ç—å' : 'Send';
    }

    chatbotToggle.addEventListener('click', () => {
      chatbotModal.style.display = chatbotModal.style.display === 'block' ? 'none' : 'block';
      if (chatbotModal.style.display === 'block' && chatbotMessages.children.length === 0) {
        addChatbotMessage(chatbotResponses[language].greeting);
      }
    });

    chatbotSend.addEventListener('click', () => {
      const message = chatbotInput.value.trim();
      if (!message) return;
      addChatbotMessage(message, true);
      chatbotInput.value = '';

      setTimeout(() => {
        const response = message.toLowerCase().includes('–ø–æ–º–æ—â—å') || message.toLowerCase().includes('help')
          ? chatbotResponses[language].help
          : chatbotResponses[language].unknown;
        addChatbotMessage(response);
      }, 1000);
    });

    chatbotInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') chatbotSend.click();
    });

    // Event listeners
    searchInput.addEventListener('input', () => {
      applyFilters();
      showSuggestions(searchInput, searchSuggestions);
    });
    mobileSearchInput.addEventListener('input', () => {
      applyFilters();
      showSuggestions(mobileSearchInput, mobileSearchSuggestions);
    });
    minPriceInput.addEventListener('input', applyFilters);
    maxPriceInput.addEventListener('input', applyFilters);
    brandFilter.addEventListener('change', applyFilters);
    sizeFilter.addEventListener('change', applyFilters);
    colorFilter.addEventListener('change', applyFilters);
    availabilityFilter.addEventListener('change', applyFilters);
    ratingFilter.addEventListener('change', applyFilters);
    sortSelect.addEventListener('change', applyFilters);

    categories.forEach(category => {
      category.addEventListener('click', () => {
        categories.forEach(cat => cat.classList.remove('bg-purple-100'));
        category.classList.add('bg-purple-100');
        applyFilters();
      });
    });

    // Close sidebar button
    closeSidebar.addEventListener('click', () => {
      sidebar.classList.remove('open');
    });

    // Login functionality
    sendCode.addEventListener('click', () => {
      const email = loginEmail.value.trim();
      if (!email) {
        showNotification(language === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ email' : 'Please enter email');
        return;
      }
      if (sendVerificationCode(email)) {
        loginCodeSection.classList.remove('hidden');
      }
    });

    verifyCode.addEventListener('click', () => {
      const code = verificationCodeInput.value.trim();
      if (!code) {
        showNotification(language === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è' : 'Please enter verification code');
        return;
      }
      if (verifyEnteredCode(code)) {
        loginUser(userEmail);
      } else {
        showNotification(language === 'ru' ? '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è' : 'Invalid verification code');
      }
    });

    // Logout functionality
    logout.addEventListener('click', logoutUser);

    cartToggle.addEventListener('click', () => cartModal.classList.toggle('hidden'));
    closeCart.addEventListener('click', () => cartModal.classList.add('hidden'));
    favoritesToggle.addEventListener('click', () => favoritesModal.classList.toggle('hidden'));
    closeFavorites.addEventListener('click', () => favoritesModal.classList.add('hidden'));
    loginToggle.addEventListener('click', () => {
      loginModal.classList.toggle('hidden');
      loginCodeSection.classList.add('hidden');
      loginEmail.value = '';
      verificationCodeInput.value = '';
    });
    closeLogin.addEventListener('click', () => loginModal.classList.add('hidden'));
    closeAccount.addEventListener('click', () => accountModal.classList.add('hidden'));
    addToCartModal.addEventListener('click', () => {
      if (selectedProduct) {
        addToCart(selectedProduct.id);
        productModal.classList.add('hidden');
      }
    });
    closeProduct.addEventListener('click', () => {
      productModal.classList.add('hidden');
      currentImageIndex = 0;
      updateCarousel();
    });
    closeQuickView.addEventListener('click', () => quickViewModal.classList.add('hidden'));
    menuToggle.addEventListener('click', () => sidebar.classList.toggle('open'));
    checkout.addEventListener('click', () => {
      if (!isLoggedIn) {
        showNotification(language === 'ru' ? '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞' : 'Please login to checkout');
        loginModal.classList.remove('hidden');
        cartModal.classList.add('hidden');
        return;
      }
      alert(language === 'ru' ? '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (–∏–º–∏—Ç–∞—Ü–∏—è)' : 'Order placement (simulation)');
      cart = [];
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCart();
      cartModal.classList.add('hidden');
      showNotification(language === 'ru' ? '–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ email.' : 'Order placed! Details sent to email.');
    });

    // Close modals when clicking outside
    document.addEventListener('click', (e) => {
      if (!sidebar.contains(e.target) && !menuToggle.contains(e.target) && !e.target.closest('.category')) {
        sidebar.classList.remove('open');
      }
    });

    // Initial render
    updateCart();
    updateFavorites();
    updateCompareCount();
    applyFilters();
    updateChatbotUI();
  </script>
</body>
</html>
